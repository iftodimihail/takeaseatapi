{"version":3,"sources":["../../src/repositories/localuri.js"],"names":["moment","require","mongoDB","db","index","find","toArray","console","error","store","body","now","unix","created_at","updated_at","insertOne","show","uniqueLink","findOne","showById","id","_id","parseInt","update","findOneAndUpdate","ObjectId","destroy","findOneAndDelete"],"mappings":";;;;;;AAAA;;;;;;;;AAEA,IAAMA,SAASC,QAAQ,QAAR,CAAf;AACA,IAAMC,UAAUD,QAAQ,SAAR,CAAhB;;kBAEe,UAACE,EAAD,EAAQ;;AAErB,MAAMC;AAAA,uEAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAEG,wBAAcD,EAAd,EAAkBE,IAAlB,GAAyBC,OAAzB,EAFH;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAIVC,sBAAQC,KAAR;AAJU;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAR;;AAAA;AAAA;AAAA;AAAA,KAAN;;AASA,MAAMC;AAAA,wEAAQ,kBAAOC,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEJC,iBAFI,GAEEX,SAASY,IAAT,EAFF;;AAGVF,mBAAKG,UAAL,GAAkBF,GAAlB;AACAD,mBAAKI,UAAL,GAAkBH,GAAlB;AAJU;AAAA,qBAKG,wBAAcR,EAAd,EAAkBY,SAAlB,CAA4BL,IAA5B,CALH;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAOVH,sBAAQC,KAAR;AAPU;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAR;;AAAA;AAAA;AAAA;AAAA,KAAN;;AAYA,MAAMQ;AAAA,wEAAO,kBAAOC,UAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAEI,wBAAcd,EAAd,EAAkBe,OAAlB,CAA0B,EAACD,sBAAD,EAA1B,CAFJ;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAITV,sBAAQC,KAAR;AAJS;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAP;;AAAA;AAAA;AAAA;AAAA,KAAN;;AASA,MAAMW;AAAA,wEAAW,kBAAOC,EAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAEA,wBAAcjB,EAAd,EAAkBe,OAAlB,CAA0B,EAACG,KAAKC,SAASF,EAAT,CAAN,EAA1B,CAFA;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAIbb,sBAAQC,KAAR;AAJa;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAX;;AAAA;AAAA;AAAA;AAAA,KAAN;;AAUA,MAAMe;AAAA,wEAAS,kBAAOH,EAAP,EAAWV,IAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAELC,iBAFK,GAECX,SAASY,IAAT,EAFD;;AAGXF,mBAAKG,UAAL,GAAkBF,GAAlB;AACAD,mBAAKI,UAAL,GAAkBH,GAAlB;AAJW;AAAA,qBAKE,wBAAcR,EAAd,EAAkBqB,gBAAlB,CAAmC,EAACH,KAAKnB,QAAQuB,QAAR,CAAiBL,EAAjB,CAAN,EAAnC,EAAgEV,IAAhE,CALF;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAOXH,sBAAQC,KAAR;AAPW;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAT;;AAAA;AAAA;AAAA;AAAA,KAAN;;AAYA,MAAMkB;AAAA,wEAAU,kBAAON,EAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAEC,wBAAcjB,EAAd,EAAkBwB,gBAAlB,CAAmC,EAACN,KAAKnB,QAAQuB,QAAR,CAAiBL,EAAjB,CAAN,EAAnC,CAFD;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAIZb,sBAAQC,KAAR;AAJY;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAV;;AAAA;AAAA;AAAA;AAAA,KAAN;;AASA,SAAO;AACLJ,gBADK;AAELK,gBAFK;AAGLO,cAHK;AAILG,sBAJK;AAKLI,kBALK;AAMLG;AANK,GAAP;AAQD,C","file":"localuri.js","sourcesContent":["import localuriModel from '../models/localuri';\r\n\r\nconst moment = require('moment');\r\nconst mongoDB = require('mongodb');\r\n\r\nexport default (db) => {\r\n\r\n  const index = async () => {\r\n    try {\r\n      return await localuriModel(db).find().toArray();\r\n    } catch (err) {\r\n      console.error(err);\r\n      throw err;\r\n    }\r\n  };\r\n\r\n  const store = async (body) => {\r\n    try {\r\n      const now = moment().unix();\r\n      body.created_at = now;\r\n      body.updated_at = now;\r\n      return await localuriModel(db).insertOne(body);\r\n    } catch (err) {\r\n      console.error(err);\r\n      throw err;\r\n    }\r\n  };\r\n\r\n  const show = async (uniqueLink) => {\r\n    try {\r\n      return await localuriModel(db).findOne({uniqueLink});\r\n    } catch (err) {\r\n      console.error(err);\r\n      throw err;\r\n    }\r\n  };\r\n\r\n  const showById = async (id) => {\r\n    try {\r\n      return await localuriModel(db).findOne({_id: parseInt(id)});\r\n    } catch (err) {\r\n      console.error(err);\r\n      throw err;\r\n    }\r\n  };\r\n\r\n\r\n  const update = async (id, body) => {\r\n    try {\r\n      const now = moment().unix();\r\n      body.created_at = now;\r\n      body.updated_at = now;\r\n      return await localuriModel(db).findOneAndUpdate({_id: mongoDB.ObjectId(id)}, body);\r\n    } catch (err) {\r\n      console.error(err);\r\n      throw err;\r\n    }\r\n  };\r\n\r\n  const destroy = async (id) => {\r\n    try {\r\n      return await localuriModel(db).findOneAndDelete({_id: mongoDB.ObjectId(id)});\r\n    } catch (err) {\r\n      console.error(err);\r\n      throw err;\r\n    }\r\n  };\r\n\r\n  return {\r\n    index,\r\n    store,\r\n    show,\r\n    showById,\r\n    update,\r\n    destroy\r\n  };\r\n}\r\n"]}