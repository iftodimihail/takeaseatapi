{"version":3,"sources":["../../src/concerns/response.js"],"names":["_","require","module","exports","res","statuses","json","response","status","respond","data","code","errors","statusText","singleError","error","general","ok","unauthorized","forbidden","notFound","internalError","collection","transformer","map","item","extraData","responseData"],"mappings":"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","file":"response.js","sourcesContent":["const _ = require('lodash');\n\nmodule.exports = (res) => {\n  const statuses = require('./statuses');\n\n  /**\n   * Returns a json response with the given input\n   *\n   * @param response (string || object)\n   * @returns {*}\n   */\n  const json = (response) => {\n    if (res) {\n      return res.status(response.status).json(response);\n    } else {\n      return response;\n    }\n  };\n\n  /**\n   * Returns a json positive response, which respects a default format.\n   * Receives data and code\n   *\n   * @param data (string || object)\n   * @param code (int)\n   * @returns {*}\n   */\n  const respond = (data, code) => {\n    return json({\n      errors: null,\n      data: data,\n      status: code,\n      statusText: statuses[code]\n    });\n  };\n\n  /**\n   * Returns a json errors response, respecting a default format.\n   * Receives errors and code\n   *\n   * @param errors (object || array)\n   * @param code (int)\n   * @returns {*}\n   */\n  const errors = (errors, code) => {\n    return json({\n      errors: errors,\n      data: null,\n      status: code,\n      statusText: statuses[code]\n    });\n  };\n\n  /**\n   * Returns a json single error response, respecting a default format.\n   * Receives error and code\n   *\n   * @param error (string || object with message)\n   * @param code (int)\n   * @returns {*}\n   */\n  const singleError = (error, code) => {\n    if (typeof(error) !== 'string') {\n      return errors(error, code ? code : 422);\n    } else {\n      return errors({\n        general: [\n          error\n        ]\n      }, code ? code : 422);\n    }\n  };\n\n  /**\n   * Returns an OK response\n   *\n   * @param code (int)\n   * @returns {*}\n   */\n  const ok = (code) => {\n    return respond(null, code ? code : 200);\n  };\n\n  /**\n   * Returns an unauthorized response\n   *\n   * @param error (string || object with message)\n   * @param code (int)\n   * @returns {*}\n   */\n  const unauthorized = (error, code) => {\n    return singleError(error, code ? code : 401);\n  };\n\n  /**\n   * Returns an forbidden response\n   *\n   * @param error (string || object with message)\n   * @param code (int)\n   * @returns {*}\n   */\n  const forbidden = (error, code) => {\n    return singleError(error, code ? code : 403);\n  };\n\n  /**\n   * Returns a not found response\n   *\n   * @param error (string || object with message)\n   * @param code (int)\n   * @returns {*}\n   */\n  const notFound = (error, code) => {\n    return singleError(error, code ? code : 404);\n  };\n\n  /**\n   * Returns an internal server error response\n   *\n   * @param error (string || object with message)\n   * @param code (int)\n   * @returns {*}\n   */\n  const internalError = (error, code) => {\n    return singleError(error, code ? code : 500);\n  };\n\n  /**\n   * Returns a response with the data collection, respecting a default format\n   *\n   * @param data\n   * @param transformer (optional)\n   * @param code (optional)\n   * @returns {*}\n   */\n  const collection = (data, transformer, code) => {\n    return respond(transformer ? _.map(data, transformer) : data, code ? code : 200);\n  };\n\n  /**\n   * Returns a response with an item, respecting a default format\n   *\n   * @param data\n   * @param transformer (optional)\n   * @param code (optional)\n   * @param extraData\n   * @returns {*}\n   */\n  const item = (data, transformer, code, extraData) => {\n    let responseData = {};\n    if (transformer) {\n      responseData = { ...transformer(data), ...extraData };\n    } else {\n      responseData = data;\n    }\n    return respond(responseData, code ? code : 200);\n  };\n\n  return {\n    collection,\n    item,\n    ok,\n    error: singleError,\n    unauthorized,\n    forbidden,\n    notFound,\n    internalError\n  };\n};\n"]}